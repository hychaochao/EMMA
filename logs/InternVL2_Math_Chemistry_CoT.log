phoenix-srun: job 3863072 queued and waiting for resources
phoenix-srun: job 3863072 has been allocated resources
phoenix-srun: Job 3863072 scheduled successfully!
Current QUOTA_TYPE is [reserved], which means the job has occupied quota in RESERVED_TOTAL under your partition.
Current PHX_PRIORITY is normal

[root] Loading dataset mm-reasoning/EMMA, subject: ['Chemistry', 'Math']
Generating test split:   0%|          | 0/1176 [00:00<?, ? examples/s]Generating test split:  17%|█▋        | 200/1176 [00:00<00:00, 1412.60 examples/s]Generating test split: 100%|██████████| 1176/1176 [00:00<00:00, 5280.12 examples/s]
Error while downloading from https://cdn-lfs-us-1.hf-mirror.com/repos/c3/c8/c3c8872e4da8c66b8f33c8f5e372df3c64e6f687520488162b6c171de214caf6/95f40e267c808e1182916cb490d706f362901c09ea4f343f176f1c68261410c4?response-content-disposition=inline%3B+filename*%3DUTF-8%27%27test-00000-of-00001.parquet%3B+filename%3D%22test-00000-of-00001.parquet%22%3B&Expires=1734261889&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTczNDI2MTg4OX19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy11cy0xLmhmLmNvL3JlcG9zL2MzL2M4L2MzYzg4NzJlNGRhOGM2NmI4ZjMzYzhmNWUzNzJkZjNjNjRlNmY2ODc1MjA0ODgxNjJiNmMxNzFkZTIxNGNhZjYvOTVmNDBlMjY3YzgwOGUxMTgyOTE2Y2I0OTBkNzA2ZjM2MjkwMWMwOWVhNGYzNDNmMTc2ZjFjNjgyNjE0MTBjND9yZXNwb25zZS1jb250ZW50LWRpc3Bvc2l0aW9uPSoifV19&Signature=AxuWLUyJd-TFXEdY10wgOm7uwDqCotGtNlQ8mP2IhxZGVZ6Bw-KdVIslFSTOebvAPNM60bG1cv5MUiQ-HTjLMQfZQmavFdIHOPYA4rZwNXwtWzaFAQ2s9GQMK6sRYVXNz1m6mYhe2ZpZX1rJzVcfvP3%7E1AOPPq7aDamh0i7Nt%7E6l0ORJRDJt70YVzjjxchbNK0JgCAFlQUpMjPbISvOiU6Y%7Eptw27l4kQH13GDcYzNzwQNxHtX9lBPIt-qUrfbqaU8hKBjaoisOEvJ2jlecNfRHIKw9w5G-EXCCoNbH5KWXw%7El0P6zgdIMVfkUOVKUX7Lgi2WEAnBSFkuz%7EiNKl7vw__&Key-Pair-Id=K24J24Z295AEI9: HTTPSConnectionPool(host='cdn-lfs-us-1.hf-mirror.com', port=443): Read timed out.
Trying to resume download...
[huggingface_hub.file_download] Error while downloading from https://cdn-lfs-us-1.hf-mirror.com/repos/c3/c8/c3c8872e4da8c66b8f33c8f5e372df3c64e6f687520488162b6c171de214caf6/95f40e267c808e1182916cb490d706f362901c09ea4f343f176f1c68261410c4?response-content-disposition=inline%3B+filename*%3DUTF-8%27%27test-00000-of-00001.parquet%3B+filename%3D%22test-00000-of-00001.parquet%22%3B&Expires=1734261889&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTczNDI2MTg4OX19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy11cy0xLmhmLmNvL3JlcG9zL2MzL2M4L2MzYzg4NzJlNGRhOGM2NmI4ZjMzYzhmNWUzNzJkZjNjNjRlNmY2ODc1MjA0ODgxNjJiNmMxNzFkZTIxNGNhZjYvOTVmNDBlMjY3YzgwOGUxMTgyOTE2Y2I0OTBkNzA2ZjM2MjkwMWMwOWVhNGYzNDNmMTc2ZjFjNjgyNjE0MTBjND9yZXNwb25zZS1jb250ZW50LWRpc3Bvc2l0aW9uPSoifV19&Signature=AxuWLUyJd-TFXEdY10wgOm7uwDqCotGtNlQ8mP2IhxZGVZ6Bw-KdVIslFSTOebvAPNM60bG1cv5MUiQ-HTjLMQfZQmavFdIHOPYA4rZwNXwtWzaFAQ2s9GQMK6sRYVXNz1m6mYhe2ZpZX1rJzVcfvP3%7E1AOPPq7aDamh0i7Nt%7E6l0ORJRDJt70YVzjjxchbNK0JgCAFlQUpMjPbISvOiU6Y%7Eptw27l4kQH13GDcYzNzwQNxHtX9lBPIt-qUrfbqaU8hKBjaoisOEvJ2jlecNfRHIKw9w5G-EXCCoNbH5KWXw%7El0P6zgdIMVfkUOVKUX7Lgi2WEAnBSFkuz%7EiNKl7vw__&Key-Pair-Id=K24J24Z295AEI9: HTTPSConnectionPool(host='cdn-lfs-us-1.hf-mirror.com', port=443): Read timed out.
Trying to resume download...
Generating test split:   0%|          | 0/892 [00:00<?, ? examples/s]Generating test split:  78%|███████▊  | 700/892 [00:00<00:00, 5603.53 examples/s]Generating test split: 100%|██████████| 892/892 [00:00<00:00, 3854.17 examples/s]
[root] Loading config
[root] Loading local model //mnt/petrelfs/share_data/quxiaoye/models/InternVL2-Llama3-76B
[transformers_modules.InternVL2-Llama3-76B.configuration_internvl_chat] vision_select_layer: -1
[transformers_modules.InternVL2-Llama3-76B.configuration_internvl_chat] ps_version: v2
[transformers_modules.InternVL2-Llama3-76B.configuration_internvl_chat] min_dynamic_patch: 1
[transformers_modules.InternVL2-Llama3-76B.configuration_internvl_chat] max_dynamic_patch: 12
/mnt/petrelfs/haoyunzhuo/anaconda3/envs/intern/lib/python3.9/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
[transformers_modules.InternVL2-Llama3-76B.modeling_internvl_chat] num_image_token: 256
[transformers_modules.InternVL2-Llama3-76B.modeling_internvl_chat] ps_version: v2
Loading checkpoint shards:   0%|          | 0/32 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/32 [00:11<05:51, 11.35s/it]Loading checkpoint shards:   6%|▋         | 2/32 [00:17<04:15,  8.52s/it]Loading checkpoint shards:   9%|▉         | 3/32 [00:24<03:40,  7.59s/it]Loading checkpoint shards:  12%|█▎        | 4/32 [00:30<03:21,  7.18s/it]Loading checkpoint shards:  16%|█▌        | 5/32 [00:37<03:05,  6.86s/it]Loading checkpoint shards:  19%|█▉        | 6/32 [00:42<02:48,  6.47s/it]Loading checkpoint shards:  22%|██▏       | 7/32 [00:50<02:52,  6.92s/it]Loading checkpoint shards:  25%|██▌       | 8/32 [00:57<02:43,  6.83s/it]Loading checkpoint shards:  28%|██▊       | 9/32 [01:04<02:35,  6.77s/it]Loading checkpoint shards:  31%|███▏      | 10/32 [01:10<02:25,  6.62s/it]Loading checkpoint shards:  34%|███▍      | 11/32 [01:16<02:19,  6.63s/it]Loading checkpoint shards:  38%|███▊      | 12/32 [01:23<02:14,  6.70s/it]Loading checkpoint shards:  41%|████      | 13/32 [01:30<02:08,  6.77s/it]Loading checkpoint shards:  44%|████▍     | 14/32 [01:37<02:03,  6.86s/it]Loading checkpoint shards:  47%|████▋     | 15/32 [01:44<01:54,  6.75s/it]Loading checkpoint shards:  50%|█████     | 16/32 [01:52<01:54,  7.16s/it]Loading checkpoint shards:  53%|█████▎    | 17/32 [01:59<01:48,  7.22s/it]Loading checkpoint shards:  56%|█████▋    | 18/32 [02:06<01:39,  7.10s/it]Loading checkpoint shards:  59%|█████▉    | 19/32 [02:12<01:27,  6.70s/it]Loading checkpoint shards:  62%|██████▎   | 20/32 [02:19<01:20,  6.67s/it]Loading checkpoint shards:  66%|██████▌   | 21/32 [02:25<01:13,  6.68s/it]Loading checkpoint shards:  69%|██████▉   | 22/32 [02:32<01:07,  6.71s/it]Loading checkpoint shards:  72%|███████▏  | 23/32 [02:39<01:01,  6.86s/it]Loading checkpoint shards:  75%|███████▌  | 24/32 [02:47<00:57,  7.14s/it]Loading checkpoint shards:  78%|███████▊  | 25/32 [02:54<00:49,  7.01s/it]Loading checkpoint shards:  81%|████████▏ | 26/32 [03:00<00:41,  6.89s/it]Loading checkpoint shards:  84%|████████▍ | 27/32 [03:08<00:35,  7.03s/it]Loading checkpoint shards:  88%|████████▊ | 28/32 [03:14<00:27,  6.92s/it]Loading checkpoint shards:  91%|█████████ | 29/32 [03:20<00:19,  6.66s/it]Loading checkpoint shards:  94%|█████████▍| 30/32 [03:27<00:13,  6.57s/it]Loading checkpoint shards:  97%|█████████▋| 31/32 [03:34<00:06,  6.68s/it]Loading checkpoint shards: 100%|██████████| 32/32 [03:39<00:00,  6.31s/it]Loading checkpoint shards: 100%|██████████| 32/32 [03:39<00:00,  6.86s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[root] Model loaded!
[root] Results already exists.
[root] Reading results/InternVL2_Math_Chemistry_CoT.json
[root] Found existing results file with 1843 problems with valid responses. Skipping these problems...
[root] Starting to generate.....
  0%|          | 0/2068 [00:00<?, ?it/s]  1%|▏         | 26/2068 [00:00<00:07, 257.53it/s]  3%|▎         | 71/2068 [00:00<00:05, 366.19it/s]  5%|▌         | 108/2068 [00:00<00:11, 172.87it/s]  6%|▋         | 133/2068 [00:02<00:48, 40.22it/s]   7%|▋         | 149/2068 [00:03<01:06, 29.06it/s] 12%|█▏        | 245/2068 [00:03<00:23, 78.94it/s] 17%|█▋        | 354/2068 [00:03<00:11, 150.81it/s] 22%|██▏       | 455/2068 [00:03<00:07, 229.98it/s] 28%|██▊       | 570/2068 [00:03<00:04, 336.90it/s] 32%|███▏      | 657/2068 [00:03<00:03, 412.21it/s] 38%|███▊      | 778/2068 [00:03<00:02, 546.12it/s] 42%|████▏     | 875/2068 [00:04<00:01, 627.10it/s] 48%|████▊     | 984/2068 [00:04<00:01, 726.80it/s] 53%|█████▎    | 1101/2068 [00:04<00:01, 830.70it/s] 58%|█████▊    | 1207/2068 [00:04<00:01, 720.65it/s] 63%|██████▎   | 1298/2068 [00:04<00:01, 657.35it/s] 67%|██████▋   | 1388/2068 [00:04<00:00, 709.61it/s] 71%|███████   | 1471/2068 [00:04<00:00, 681.66it/s] 75%|███████▍  | 1547/2068 [00:04<00:00, 659.98it/s] 79%|███████▊  | 1628/2068 [00:05<00:00, 696.07it/s] 83%|████████▎ | 1707/2068 [00:05<00:00, 713.10it/s] 86%|████████▌ | 1782/2068 [00:05<00:00, 619.19it/s]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 86%|████████▌ | 1782/2068 [00:19<00:00, 619.19it/s] 89%|████████▉ | 1847/2068 [00:30<00:22,  9.91it/s] Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 89%|████████▉ | 1848/2068 [00:47<00:42,  5.14it/s]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 89%|████████▉ | 1849/2068 [00:51<00:48,  4.48it/s]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 89%|████████▉ | 1849/2068 [01:01<00:48,  4.48it/s] 89%|████████▉ | 1850/2068 [01:04<01:19,  2.74it/s]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 90%|████████▉ | 1851/2068 [01:07<01:30,  2.41it/s]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 90%|████████▉ | 1851/2068 [01:19<01:30,  2.41it/s] 90%|████████▉ | 1853/2068 [01:30<03:11,  1.13it/s]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 90%|████████▉ | 1854/2068 [01:34<03:30,  1.02it/s]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 90%|████████▉ | 1854/2068 [01:45<03:30,  1.02it/s] 90%|████████▉ | 1857/2068 [01:46<04:36,  1.31s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 90%|████████▉ | 1858/2068 [02:03<07:18,  2.09s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 90%|████████▉ | 1859/2068 [02:07<07:45,  2.23s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
[root] Save results to results/InternVL2_Math_Chemistry_CoT.json
Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 90%|████████▉ | 1859/2068 [02:19<07:45,  2.23s/it] 90%|█████████ | 1863/2068 [02:27<10:20,  3.03s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 90%|█████████ | 1864/2068 [02:31<10:37,  3.12s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 90%|█████████ | 1864/2068 [02:41<10:37,  3.12s/it] 90%|█████████ | 1867/2068 [03:09<19:33,  5.84s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 90%|█████████ | 1868/2068 [03:17<20:04,  6.02s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 90%|█████████ | 1868/2068 [03:29<20:04,  6.02s/it] 90%|█████████ | 1870/2068 [03:58<32:08,  9.74s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 90%|█████████ | 1871/2068 [04:03<29:10,  8.88s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 90%|█████████ | 1871/2068 [04:15<29:10,  8.88s/it] 91%|█████████ | 1874/2068 [04:23<26:12,  8.11s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████ | 1875/2068 [04:35<27:45,  8.63s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████ | 1876/2068 [04:39<24:56,  7.79s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████ | 1876/2068 [04:49<24:56,  7.79s/it] 91%|█████████ | 1877/2068 [04:50<27:16,  8.57s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████ | 1878/2068 [04:54<23:40,  7.47s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████ | 1878/2068 [05:05<23:40,  7.47s/it] 91%|█████████ | 1879/2068 [05:10<30:02,  9.54s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████ | 1880/2068 [05:22<31:38, 10.10s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
[root] Save results to results/InternVL2_Math_Chemistry_CoT.json
 91%|█████████ | 1881/2068 [05:26<26:25,  8.48s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████ | 1883/2068 [05:33<19:48,  6.43s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████ | 1883/2068 [05:45<19:48,  6.43s/it] 91%|█████████ | 1884/2068 [05:47<25:14,  8.23s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████ | 1885/2068 [05:55<24:24,  8.00s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████ | 1886/2068 [05:59<21:06,  6.96s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████ | 1887/2068 [06:03<18:35,  6.16s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████▏| 1888/2068 [06:21<29:03,  9.69s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████▏| 1889/2068 [06:26<24:05,  8.08s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████▏| 1890/2068 [06:34<24:30,  8.26s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████▏| 1891/2068 [06:38<20:17,  6.88s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 91%|█████████▏| 1892/2068 [06:46<20:52,  7.12s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1893/2068 [06:50<18:07,  6.21s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1894/2068 [07:00<21:38,  7.46s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1895/2068 [07:04<18:06,  6.28s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1896/2068 [07:07<15:38,  5.46s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1897/2068 [07:17<19:38,  6.89s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1898/2068 [07:50<41:49, 14.76s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1899/2068 [07:55<32:34, 11.57s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1900/2068 [08:07<33:09, 11.84s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
[root] Save results to results/InternVL2_Math_Chemistry_CoT.json
 92%|█████████▏| 1901/2068 [08:16<30:44, 11.04s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1902/2068 [08:25<28:37, 10.35s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1903/2068 [08:45<36:48, 13.38s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1904/2068 [08:56<34:14, 12.53s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1905/2068 [09:00<26:55,  9.91s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1906/2068 [09:03<21:33,  7.99s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1907/2068 [09:09<19:59,  7.45s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1908/2068 [09:14<17:10,  6.44s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1909/2068 [09:18<15:12,  5.74s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1910/2068 [09:22<13:47,  5.24s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1911/2068 [09:26<12:46,  4.88s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 92%|█████████▏| 1912/2068 [09:40<19:50,  7.63s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1913/2068 [09:44<16:59,  6.58s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1914/2068 [10:04<27:02, 10.53s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1915/2068 [10:28<37:29, 14.70s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1916/2068 [10:37<32:28, 12.82s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1917/2068 [10:41<25:40, 10.20s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1918/2068 [10:53<26:47, 10.72s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1919/2068 [10:56<21:16,  8.57s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1920/2068 [11:00<17:47,  7.21s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
[root] Save results to results/InternVL2_Math_Chemistry_CoT.json
 93%|█████████▎| 1921/2068 [11:09<18:58,  7.75s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1922/2068 [11:13<16:10,  6.65s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1923/2068 [11:17<14:11,  5.87s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1924/2068 [11:21<12:47,  5.33s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1925/2068 [11:30<15:06,  6.34s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1926/2068 [12:03<33:47, 14.28s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1927/2068 [12:21<35:58, 15.31s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1928/2068 [12:25<27:51, 11.94s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1929/2068 [12:33<25:01, 10.80s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1930/2068 [12:37<20:13,  8.79s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1931/2068 [12:46<20:23,  8.93s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1932/2068 [12:50<16:58,  7.49s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 93%|█████████▎| 1933/2068 [12:54<14:32,  6.46s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▎| 1934/2068 [12:58<12:50,  5.75s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▎| 1935/2068 [13:22<24:51, 11.21s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▎| 1936/2068 [13:27<20:03,  9.11s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▎| 1937/2068 [13:31<16:36,  7.60s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▎| 1938/2068 [13:35<14:22,  6.63s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1939/2068 [13:44<15:41,  7.30s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1940/2068 [13:48<13:31,  6.34s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
[root] Save results to results/InternVL2_Math_Chemistry_CoT.json
 94%|█████████▍| 1941/2068 [13:55<13:46,  6.51s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1942/2068 [13:59<12:10,  5.80s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1943/2068 [14:26<25:34, 12.27s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1944/2068 [14:40<26:02, 12.60s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1945/2068 [14:43<20:16,  9.89s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1946/2068 [14:47<16:32,  8.14s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1947/2068 [15:05<22:22, 11.09s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1948/2068 [15:09<17:39,  8.83s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1949/2068 [15:27<22:46, 11.48s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1950/2068 [15:38<22:35, 11.49s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1951/2068 [15:55<25:23, 13.02s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1952/2068 [16:07<24:57, 12.91s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1953/2068 [16:11<19:41, 10.27s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 94%|█████████▍| 1954/2068 [16:16<15:58,  8.41s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▍| 1955/2068 [16:19<13:03,  6.94s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▍| 1956/2068 [16:23<11:20,  6.08s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▍| 1957/2068 [16:27<09:49,  5.31s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▍| 1958/2068 [16:31<09:03,  4.94s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▍| 1959/2068 [16:35<08:29,  4.67s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▍| 1960/2068 [16:54<16:07,  8.96s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
[root] Save results to results/InternVL2_Math_Chemistry_CoT.json
 95%|█████████▍| 1961/2068 [17:00<14:31,  8.14s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▍| 1962/2068 [17:04<12:13,  6.92s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▍| 1963/2068 [17:14<13:56,  7.97s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▍| 1964/2068 [17:18<11:39,  6.72s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▌| 1965/2068 [17:28<13:04,  7.61s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▌| 1966/2068 [17:31<10:51,  6.39s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▌| 1967/2068 [17:36<09:34,  5.69s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▌| 1968/2068 [17:39<08:23,  5.03s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▌| 1969/2068 [18:05<18:31, 11.23s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▌| 1970/2068 [19:05<42:32, 26.05s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▌| 1971/2068 [19:50<51:01, 31.56s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▌| 1972/2068 [20:25<52:06, 32.56s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▌| 1973/2068 [21:02<53:42, 33.92s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 95%|█████████▌| 1974/2068 [21:39<54:39, 34.89s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1975/2068 [22:06<50:27, 32.56s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1976/2068 [23:01<1:00:26, 39.41s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1977/2068 [23:55<1:06:00, 43.53s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1978/2068 [24:33<1:03:03, 42.04s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1979/2068 [25:42<1:14:13, 50.04s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1980/2068 [26:14<1:05:19, 44.54s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
[root] Save results to results/InternVL2_Math_Chemistry_CoT.json
 96%|█████████▌| 1981/2068 [27:08<1:09:02, 47.62s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1982/2068 [27:27<55:37, 38.81s/it]  Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1983/2068 [28:18<1:00:08, 42.46s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1984/2068 [29:26<1:10:25, 50.30s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1985/2068 [30:15<1:08:46, 49.72s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1986/2068 [31:39<1:22:00, 60.01s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1987/2068 [32:30<1:17:40, 57.54s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1988/2068 [33:25<1:15:23, 56.55s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1989/2068 [33:48<1:01:22, 46.61s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▌| 1990/2068 [34:28<57:55, 44.56s/it]  Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▋| 1991/2068 [36:05<1:17:29, 60.39s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▋| 1992/2068 [36:47<1:09:35, 54.94s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▋| 1993/2068 [37:54<1:13:09, 58.53s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▋| 1994/2068 [38:24<1:01:30, 49.87s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 96%|█████████▋| 1995/2068 [39:10<59:22, 48.80s/it]  Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 1996/2068 [39:55<57:04, 47.56s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 1997/2068 [40:17<47:04, 39.78s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 1998/2068 [40:47<43:12, 37.03s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 1999/2068 [41:17<40:00, 34.78s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2000/2068 [42:19<48:47, 43.05s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
[root] Save results to results/InternVL2_Math_Chemistry_CoT.json
 97%|█████████▋| 2001/2068 [42:46<42:44, 38.27s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2002/2068 [44:06<55:45, 50.69s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2003/2068 [44:35<47:48, 44.13s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2004/2068 [45:20<47:30, 44.54s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2005/2068 [45:55<43:35, 41.52s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2006/2068 [46:31<41:14, 39.91s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2007/2068 [47:12<41:00, 40.33s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2008/2068 [47:40<36:41, 36.70s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2009/2068 [48:46<44:38, 45.40s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2010/2068 [49:42<47:05, 48.71s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2011/2068 [50:22<43:41, 45.99s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2012/2068 [50:53<38:41, 41.46s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2013/2068 [51:28<36:10, 39.47s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2014/2068 [51:58<32:56, 36.60s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2015/2068 [52:24<29:39, 33.57s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 97%|█████████▋| 2016/2068 [52:56<28:38, 33.06s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2017/2068 [53:38<30:14, 35.59s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2018/2068 [54:04<27:19, 32.79s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2019/2068 [54:45<28:52, 35.36s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2020/2068 [55:27<29:50, 37.30s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
[root] Save results to results/InternVL2_Math_Chemistry_CoT.json
 98%|█████████▊| 2021/2068 [56:11<30:43, 39.22s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2022/2068 [56:57<31:48, 41.49s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2023/2068 [57:54<34:34, 46.10s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2024/2068 [58:44<34:29, 47.04s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2025/2068 [59:20<31:22, 43.77s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2026/2068 [1:00:11<32:12, 46.01s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2027/2068 [1:00:54<30:47, 45.05s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2028/2068 [1:01:33<28:46, 43.17s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2029/2068 [1:02:23<29:24, 45.25s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2030/2068 [1:02:55<26:14, 41.43s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2031/2068 [1:03:42<26:29, 42.97s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2032/2068 [1:04:21<25:11, 41.99s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2033/2068 [1:05:09<25:33, 43.81s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2034/2068 [1:05:42<22:58, 40.55s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2035/2068 [1:06:29<23:15, 42.28s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 98%|█████████▊| 2036/2068 [1:07:01<20:58, 39.34s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▊| 2037/2068 [1:07:38<19:52, 38.48s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▊| 2038/2068 [1:08:33<21:49, 43.63s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▊| 2039/2068 [1:09:02<18:54, 39.12s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▊| 2040/2068 [1:09:46<18:57, 40.64s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
[root] Save results to results/InternVL2_Math_Chemistry_CoT.json
 99%|█████████▊| 2041/2068 [1:10:24<17:57, 39.91s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▊| 2042/2068 [1:11:12<18:21, 42.37s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2043/2068 [1:11:56<17:48, 42.75s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2044/2068 [1:12:34<16:30, 41.27s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2045/2068 [1:13:18<16:06, 42.02s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2046/2068 [1:13:55<14:51, 40.51s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2047/2068 [1:14:41<14:46, 42.20s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2048/2068 [1:15:18<13:35, 40.78s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2049/2068 [1:16:15<14:24, 45.49s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2050/2068 [1:16:44<12:10, 40.60s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2051/2068 [1:17:27<11:42, 41.30s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2052/2068 [1:18:05<10:46, 40.43s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2053/2068 [1:18:38<09:32, 38.20s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2054/2068 [1:19:12<08:36, 36.88s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2055/2068 [1:19:41<07:27, 34.44s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2056/2068 [1:20:37<08:12, 41.03s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
 99%|█████████▉| 2057/2068 [1:21:17<07:26, 40.58s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
100%|█████████▉| 2058/2068 [1:21:56<06:41, 40.11s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
100%|█████████▉| 2059/2068 [1:22:58<07:01, 46.80s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
100%|█████████▉| 2060/2068 [1:23:45<06:15, 46.93s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
[root] Save results to results/InternVL2_Math_Chemistry_CoT.json
100%|█████████▉| 2061/2068 [1:24:50<06:04, 52.13s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
100%|█████████▉| 2062/2068 [1:25:38<05:05, 50.86s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
100%|█████████▉| 2063/2068 [1:26:21<04:03, 48.68s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
100%|█████████▉| 2064/2068 [1:27:14<03:19, 49.95s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
100%|█████████▉| 2065/2068 [1:27:50<02:16, 45.65s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
100%|█████████▉| 2066/2068 [1:28:36<01:31, 45.74s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
100%|█████████▉| 2067/2068 [1:29:32<00:48, 48.90s/it]Setting `pad_token_id` to `eos_token_id`:128003 for open-end generation.
[root] Save results to results/InternVL2_Math_Chemistry_CoT.json
100%|██████████| 2068/2068 [1:30:19<00:00, 48.33s/it]100%|██████████| 2068/2068 [1:30:19<00:00,  2.62s/it]
[root] Save results to results/InternVL2_Math_Chemistry_CoT.json
[root] End Generation......
torch.cat(): expected a non-empty list of Tensors
